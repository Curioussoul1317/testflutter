  <IfModule mod_rewrite.c>
      RewriteEngine On

      # Handle Authorization Header
      RewriteCond %{HTTP:Authorization} .
      RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]

      # Route Laravel API/routes to index.php (Laravel entry point)
      RewriteRule ^payonline(.*)$ index.php [L]
      RewriteRule ^api(.*)$ index.php [L]
      RewriteRule ^logout(.*)$ index.php [L]
      RewriteRule ^efaas(.*)$ index.php [L]
      RewriteRule ^payment-info(.*)$ index.php [L]
      RewriteRule ^bills/receipt(.*)$ index.php [L]

      # If the request is for an existing file or directory, serve it directly
      RewriteCond %{REQUEST_FILENAME} -f [OR]
      RewriteCond %{REQUEST_FILENAME} -d
      RewriteRule ^ - [L]

      # Otherwise, serve index.html (Flutter SPA) and preserve query string
      RewriteRule ^ index.html [L,QSA]
  </IfModule>

  # Enable CORS for API requests
  <IfModule mod_headers.c>
      Header set Access-Control-Allow-Origin "*"
      Header set Access-Control-Allow-Methods "GET, POST, OPTIONS, PUT, DELETE"
      Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Requested-With"
  </IfModule>

  # Caching for static assets
  <IfModule mod_expires.c>
      ExpiresActive On
      ExpiresByType text/html "access plus 0 seconds"
      ExpiresByType text/css "access plus 1 year"
      ExpiresByType application/javascript "access plus 1 year"
      ExpiresByType image/png "access plus 1 year"
      ExpiresByType image/jpeg "access plus 1 year"
      ExpiresByType image/gif "access plus 1 year"
      ExpiresByType image/svg+xml "access plus 1 year"
      ExpiresByType font/woff2 "access plus 1 year"
  </IfModule>